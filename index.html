<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans+Caption:wght@400;700&display=swap" rel="stylesheet" />
    <link href="./output.css" rel="stylesheet" />
  </head>

  <body class="m-0 h-screen bg-[rgb(49,46,38)] p-4">
    <div class="relative h-full max-h-[450px] w-full overflow-hidden rounded-[20px] bg-white">
      <img src="https://static.tildacdn.com/tild6664-3536-4231-b664-666530313930/Group_29.svg" class="absolute left-6 top-6" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
      <div class="ladder relative mt-8 aspect-square w-full max-w-[500px]">
        <div class="corner-gradient absolute right-0 top-0 z-50"></div>
        <div class="interceptor absolute z-50 h-full w-full overflow-y-hidden">
          <div class="h-2 w-[6060px]"></div>
        </div>
        <div class="wrapper -mr-4 h-full w-full overflow-auto">
          <div class="content relative h-[6060px] w-[6060px]">
            <svg fill="none" class="ladder-fill absolute bottom-0 left-0 h-full w-full">
              <path stroke="" stroke-width="0" stroke-linejoin="round" fill="#F588593D" />
            </svg>

            <svg fill="none" class="absolute bottom-0 left-0 h-full w-full">
              <path
                stroke="url(#paint0_linear_1887_3134)"
                stroke-width="4"
                stroke-linejoin="round"
                d="M2 6060
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60 
                v-60 h60
  
                h60 
                "
              />
              <defs>
                <linearGradient
                  id="paint0_linear_1887_3134"
                  x2="0%"
                  y2="0%"
                  x1="100%"
                  y1="0%"
                  gradientUnits="userSpaceOnUse"
                  gradientTransform="rotate(90)"
                >
                  <stop offset="0%" stop-color="#F58859" />
                  <stop class="ladder-gradient-start" stop-color="#F58859" />
                  <stop class="ladder-gradient-end" stop-color="#EDEDED" />
                  <stop offset="100%" stop-color="#EDEDED" />
                </linearGradient>
              </defs>
            </svg>

            <div class="user-marker absolute h-[40px] w-[40px] rounded-full bg-cover"></div>
            <div class="digits relative h-full w-full"></div>
          </div>
        </div>
      </div>
      <div class="mx-auto mt-5 h-2 w-[95%] rounded-full bg-[#EDEDED]">
        <div class="scrollbar-thumb-wrapper flex h-full w-full justify-end">
          <div class="scrollbar-thumb h-full w-10 rounded-full bg-[#B4B4C8]"></div>
        </div>
      </div>
    </div>

    <style>
      .interceptor,
      .wrapper {
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      .user-marker {
        background-image: url('https://images.unsplash.com/photo-1461988320302-91bde64fc8e4?ixid=2yJhcHBfaWQiOjEyMDd9&fm=jpg&w=700&h=700&fit=min');
      }
      .digits {
        font-size: 20px;
        font-weight: 600;
        color: #b4b4c8;
        text-align: center;
        font-family: 'PT Sans Caption', sans-serif;
      }
      .digit {
        position: absolute;
        width: 60px;
      }
      .digit--completed {
        color: #f1a38c;
      }
      .digit--current {
        color: #e8653f;
        font-weight: 700;
      }
      .corner-gradient {
        width: 50%;
        height: 40px;
        background-image: linear-gradient(to bottom, rgb(255, 255, 255) 0%, rgb(255, 255, 255) 30%, rgba(192, 23, 23, 0) 100%);
      }
    </style>
    <script>
      const CONFIG = {
        ladderWidth: 6060,
        maxWrapperWidth: 500,
        stepWidth: 60,
        defaultStepOffset: 3.3,
      };

      try {
        const offset = initWrapperScrollPosition(15);
        initScrollingController(offset, 15);

        renderDigits(15);
        renderUserMarker(15);
        renderLadderGradient(15);
        renderLadderFill(15);

        function initScrollingController(offset, step) {
          const wrapper = document.querySelector('.wrapper');
          const interceptor = document.querySelector('.interceptor');
          // const thumbWrapper = document.querySelector('.scrollbar-thumb-wrapper');
          // const thumbWrapperInnerWidth = thumbWrapper.offsetWidth;

          interceptor.scrollLeft = 0 + (step - CONFIG.defaultStepOffset) * CONFIG.stepWidth;

          let isScrolling;

          const syncScroll = (value) => {
            // console.log('syncScroll', value, Math.floor((value / CONFIG.ladderWidth) * 100));
            window.clearTimeout(isScrolling);
            isScrolling = setTimeout(() => {
              wrapper.scrollLeft = value;
              wrapper.scrollTop = CONFIG.ladderWidth - offset - value;
              // thumbWrapper.style.width = (value / CONFIG.ladderWidth) * thumbWrapperInnerWidth + 40 + 'px';
            }, 5);
          };

          interceptor.addEventListener('scroll', (e) => {
            requestAnimationFrame(() => {
              syncScroll(e.target.scrollLeft);
            });
          });
        }

        function renderDigits(step) {
          const digits = document.querySelector('.digits');
          for (let index = 0; index < 100; index += 1) {
            const element = document.createElement('div');
            element.classList.add('digit');
            element.textContent = index + 1;
            element.style.bottom = `calc(${index * 0.99}% + 27px)`;
            element.style.left = `calc(${index * 0.99}% + 2px)`;
            if (index + 1 === step) element.classList.add('digit--current');
            if (index + 1 < step) element.classList.add('digit--completed');
            digits.append(element);
          }
        }

        function renderUserMarker(step) {
          const userMarker = document.querySelector('.user-marker');
          userMarker.style.bottom = `calc(${step * 0.99}% + 10px)`;
          userMarker.style.left = `calc(${step * 0.99 - 1}% + 11px)`;
        }

        function renderLadderGradient(step) {
          const start = document.querySelector('.ladder-gradient-start');
          const end = document.querySelector('.ladder-gradient-end');
          start.setAttribute('offset', `${step}%`);
          end.setAttribute('offset', `${step}.4%`);
        }

        function renderLadderFill(step) {
          const path = document.querySelector('.ladder-fill path');
          // REFERENCE: 'M2 6060 v-60 h60 v-60 h60 v-60 h60 v-60 h60 v-60 h60 v-60 h60 v-60 h60 v-60 h60 v-60 h60 v-60 h60 v-60 H6060 V6060'
          // M2 6060 - start; v-60 h60 - step; v-60 H6060 V6060 - finish
          const pathDefinition = `M2 ${CONFIG.ladderWidth} ${Array.from({ length: step - 1 }, (_, i) => i + 1).map(
            (x) => `v-${CONFIG.stepWidth} h${CONFIG.stepWidth}`
          )} v-60 H6060 V6060`;
          path.setAttribute('d', pathDefinition);
        }

        function initWrapperScrollPosition(step) {
          const wrapper = document.querySelector('.wrapper');
          const offset = Math.min(wrapper.offsetWidth, CONFIG.maxWrapperWidth);
          wrapper.scrollTop = CONFIG.ladderWidth - offset - (step - CONFIG.defaultStepOffset) * CONFIG.stepWidth;
          wrapper.scrollLeft = 0 + (step - CONFIG.defaultStepOffset) * CONFIG.stepWidth;
          return offset;
        }
      } catch (error) {
        alert(error);
        throw error;
      }
    </script>
  </body>
</html>
